

{% block title %}GAMENEWS-Noticia{% endblock %}

{% extends 'base.html.twig' %}

{% block body %}
    
    <div>
    <div>
        <img src="{{ asset('images/' ~ noticia.imagen) }}" alt="{{ noticia.titulo }}">
        <h1>{{ noticia.titulo }}</h1>
        <h2>{{ noticia.subtitulo }}</h2>
        <small>{{ noticia.fechaPublicacion|date('d M Y') }}</small><br>
        <p> {{ noticia.cuerpo }}</p>
    </div>
    <!--BLoque para votar la noticia-->
    <form method="post" action="{{ path('noticia_votar', {id: noticia.id}) }}">
    <label>Califica esta noticia:</label>
    {% for i in 1..5 %}
        <input type="radio" name="puntuacion" value="{{ i }}"> {{ i }} ‚≠ê
    {% endfor %}
    <button type="submit">Votar</button>
    </form> 
    <p>Promedio: {{ noticia.promedioVotos }} / 5</p>
    
    <!--Bloque para realizar un comentario-->
    {% if app.user %}
        <h3>Comentarios</h3>
        <form action="{{ path('agregar_comentario', {id: noticia.id}) }}" method="post">
        <textarea name="contenido" rows="4" required></textarea>
        <button type="submit">Enviar</button>
    {% else %}
        <p> Usuario no autenticado. Inicia sesion para dejar un comentario.</p>
        <a href="{{ path('app_iniciar_sesion') }}"><button>iniciar sesi√≥n</button></a>
    {% endif %}
    <div>

</div>
    <div>
    <!--Bloque para mostrar los comentarios (si los hay)-->
    <h4>Comentarios existentes:</h4>
        {%if noticia.comentarios is empty %}
            <p>No hay comentarios a√∫n. S√© el primero en comentar!</p>
        {% else %}
        {% for comentario in noticia.comentarios %}
            <div style="border: 1px solid #ccc; padding: 10px; margin-bottom: 10px;">
                <p><strong>{{ comentario.usuario.nombreUsuario }}</strong></p>
                <p>{{ comentario.contenido }}</p>
                <p>
                    <a href="{{ path('votar_comentario', {id: comentario.id, valor: 1}) }}">
                        <button>üëç{{ comentario.votoComentarios|filter(v => v.valor)|length }}</button>
                    </a>
                    <a href="{{ path('votar_comentario', {id: comentario.id, valor: 0}) }}">
                        <button>üëé{{ comentario.votoComentarios|filter(v => not v.valor)|length }}</button>
                    </a>
                    <br>
                    <a href="{{ path('comentario_denunciar', {id: comentario.id}) }}" class="btn btn-warning btn-sm">Reportar</a>
                <p>
            </div>
        {% endfor %}
    {% endif %}
    </div>
</div>
{% endblock %}