@startuml Diagrama de Secuencia - Comentar Noticia
actor Usuario
participant "ComentarioController" as ComentarioController
participant "EntityManagerInterface" as EM
participant "Noticia" as NoticiaEntity

Usuario -> ComentarioController : POST /noticia/{id}/comentario\nagregarComentario(Request, EM, id)
activate ComentarioController
ComentarioController -> EM : getRepository(Noticia::class)->find(id)
activate EM
EM --> ComentarioController : Noticia|null
deactivate EM
alt noticia encontrada
ComentarioController -> ComentarioController : getUser() // chequear autenticaciÃ³n
alt usuario autenticado
ComentarioController -> EM : persist(Comentario)
activate EM
EM --> ComentarioController : ok
ComentarioController -> EM : flush()
EM --> ComentarioController : ok
deactivate EM
ComentarioController --> Usuario : redirect(app_pagina_noticia)
else no autenticado
ComentarioController --> Usuario : redirect(app_pagina_noticia) // no inserta
end
else not found
ComentarioController --> Usuario : 404
end
deactivate ComentarioController
@enduml